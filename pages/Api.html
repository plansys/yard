<js:this.state.tag>
    <js>
        if (this.state.debug && this.state.drag) {
            return <div onMouseUp="js: this.doneDragging"
                    onMouseMove="js: this.mouseMove"
                    className="db-query-debug-overlay"></div>
        }
    </js>
    <js>
        if (this.state.debug) {
            return <div className="js: 'db-query-debug ' + (this.state.drag ? 'drag' : '')"
                    onMouseDown="js: this.mouseDown"
                    onMouseMove="js: this.mouseMove"
                    onMouseUp="js: this.doneDragging"
                    style="js: this.debugStyle()">
                    <div className="title">
                        <b>
                            API
                            | <js> this.props.page || this.page </js>
                            | <js> this.state.loading ? '⏰ ' : '' </js>
                        </b>
                        <div className="query" >
                            <button onClick="js: this.debugToggle">
                                <js>this.state.debugMax ? '▲' : '▼'</js>
                            </button>
                            <button
                                disabled="js: !this.state.paramsValid"
                                onClick="js: () => { this.query(this.state.params, false) } ">Query</button>
                        </div>
                    </div>
                    <js>
                    if (this.state.debugMax) {
                        return <el>
                            <div className="db-query-content">
                                <div className="params-title">Params:
                                    <js>
                                        if (this.state.paramsValid) {
                                            return <el><b className="params-status-valid">VALID</b></el>;
                                        } else {
                                            return <el><b className="params-status-invalid">INVALID</b></el>;
                                        }
                                    </js>
                                </div>
                                <textarea
                                    onMouseDown="js: e => { e.stopPropagation();}"
                                    className="js: 'params ' + (!this.state.paramsValid ? 'invalid' : '')  "
                                    autoComplete="off" autoCorrect="off"
                                    autoCapitalize="off" spellCheck="false"
                                    onChange="js: this.paramsChange"
                                    value="js: this.state.paramsText "></textarea>
                                <div className="result-title">
                                    Result:
                                </div>
                                <div onMouseDown="js: e => { e.stopPropagation();}"
                                     style="js: {
                                        maxHeight: '200px',
                                        overflowY: 'auto'
                                     }"
                                     dangerouslySetInnerHTML="js: {__html: (typeof this.state.result == 'string'
                                    ? this.state.result
                                    : JSON.stringify(this.state.result, null, 2)) }"></div>
                            </div>
                        </el>
                    }
                    </js>
                </div>
        }
    </js>
</js:this.state.tag>